// Database config
datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

// Generator
generator client {
  provider = "prisma-client-js"
}

// Enum roles
enum Role {
  ADMIN
  MODERATOR
  USER
}

// Enum status - 'active', 'idle', 'doNotDisturb', 'offline'
enum Status {
  ACTIVE
  IDLE
  DO_NOT_DISTURB
  OFFLINE
}

model User {
  // User autogenerated id
  id         Int       @id @default(autoincrement())
  // User custom name
  username   String
  // User email - unique and changeable
  email      String    @unique
  // Hashed password
  password   String
  // Optional user avatar
  avatar     String?
  // User role - default is USER
  role       Role      @default(USER)
  // User status - default is OFFLINE - dynamic
  status     Status    @default(OFFLINE)
  // Last active
  lastActive DateTime
  // User created at - auto generated
  createdAt  DateTime  @default(now())
  // User updated at - auto generated on update
  updatedAt  DateTime  @updatedAt
  // Sessions list
  sessions   Session[]
}

model Session {
  // App-generated session id
  id        String   @id
  // User id reference
  user_id   Int
  // Session expires at
  expiresAt DateTime
  // User relation
  user      User     @relation(references: [id], fields: [user_id], onDelete: Cascade)
}
